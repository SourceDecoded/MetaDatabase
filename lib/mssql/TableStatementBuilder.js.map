{"version":3,"sources":["../../src/mssql/TableStatementBuilder.js"],"names":["defaultRelationships","oneToOne","oneToMany","TableStatementBuilder","dataTypeMapping","name","table","schema","query","entity","Error","sqliteEntity","columns","values","filterRelevantColumns","forEach","column","columnName","defaultValue","getDefaultValue","push","_escapeName","toMssqlValue","columnsStatement","join","valuesStatement","Array","length","fill","statement","delta","primaryKeyExpr","primaryKeyValues","columnSet","Object","keys","type","toSqliteValue","getPrimaryKeys","key","concat","primaryKeysExpr","primaryKeys","primaryKey","sqliteDataType","primaryKeyStatment","isPrimaryKey","isAutoIncrement","columnsDefinition","map","createColumnDefinitionStatement","filter","value","replace","relationships","indexedColumns","foreignKeyIndexes","getTablesRelationshipsAsTargets","relationship","withForeignKey","getTablesRelationshipsAsSources","indexOf","hasKey","isIndexed","createIndexStatement","tableRelationships","createForeignKeyStatement","ofType","assign","columnDefinitionsStatement","createColumnsDefinitionStatement","foreignKeysStatement","createForeignKeysStatement","_wrapIfTableExists","foreignKeyNames","foreignKey","keyNames","find","Date","getTime"],"mappings":"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","file":"TableStatementBuilder.js","sourcesContent":["import dataTypeMapping from \"./dataTypeMapping\";\n\nconst defaultRelationships = {\n    oneToOne: [],\n    oneToMany: []\n}\n\nexport default class TableStatementBuilder {\n    constructor() {\n        this.dataTypeMapping = dataTypeMapping;\n    }\n\n    _escapeName(name) {\n        return `[${name}]`;\n    }\n\n    _wrapIfTableExists(table, schema, query) {\n        return `IF NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES \n            WHERE TABLE_SCHEMA = '${schema}' AND TABLE_NAME = '${table.name}'))\n            BEGIN\n            ${query}\n            END`\n    }\n\n    createDropTableStatement(schema, table) {\n        return `IF OBJECT_ID('${schema}.${table.name}', 'U') IS NOT NULL DROP TABLE ${schema}.${table.name};`\n    }\n\n    createInsertStatement(schema, table, entity) {\n        if (table == null) {\n            throw new Error(\"null Argument Exception: schema cannot be null or undefined.\");\n        }\n\n        if (table == null) {\n            throw new Error(\"Null Argument Exception: table cannot be null or undefined.\");\n        }\n\n        if (entity == null) {\n            throw new Error(\"Null Argument Exception: entity cannot be null or undefined.\");\n        }\n\n        const sqliteEntity = {};\n        const columns = [];\n        const values = [];\n\n        this.filterRelevantColumns(table.columns).forEach((column) => {\n            var columnName = column.name;\n            var defaultValue = this.getDefaultValue(column);\n\n            if (typeof entity[columnName] !== \"undefined\" && entity[columnName] !== null) {\n                columns.push(this._escapeName(columnName));\n\n                if (entity[columnName] === null) {\n                    values.push(this.toMssqlValue(defaultValue));\n                } else {\n                    values.push(this.toMssqlValue(entity[columnName]));\n                }\n            }\n        });\n\n        const columnsStatement = columns.join(\", \");\n        const valuesStatement = new Array(values.length).fill(\"?\").join(\", \");\n\n        if (values.length === 0) {\n            return {\n                statement: `INSERT INTO [${schema}].[${table.name}] () VALUES (); SELECT SCOPE_IDENTITY() AS id;`,\n                values: values\n            };\n        }\n\n        return {\n            statement: `INSERT INTO [${schema}].[${table.name}] (${columnsStatement}) VALUES (${valuesStatement}); SELECT SCOPE_IDENTITY() AS id`,\n            values: values\n        };\n\n    }\n\n    createUpdateStatement(schema, table, entity, delta) {\n        let values = [];\n        const primaryKeyExpr = [];\n        const primaryKeyValues = [];\n        const columnSet = [];\n        const columns = table.columns;\n\n        if (schema == null) {\n            throw new Error(\"Null Argument Exception: schema cannot be null or undefined.\");\n        }\n\n        if (table == null) {\n            throw new Error(\"Null Argument Exception: table cannot be null or undefined.\");\n        }\n\n        if (entity == null) {\n            throw new Error(\"Null Argument Exception: entity cannot be null or undefined.\");\n        }\n\n        if (delta == null) {\n            throw new Error(\"Null Argument Exception: delta cannot be null or undefined.\");\n        }\n\n        if (Object.keys(delta).length === 0) {\n            throw new Error(\"Invalid Argument: delta cannot an empty object.\");\n        }\n\n        this.filterRelevantColumns(columns).forEach((column) => {\n            var columnName = column.name;\n\n            if (typeof delta[columnName] !== \"undefined\" && this.dataTypeMapping[column.type] != null) {\n                columnSet.push(this._escapeName(columnName) + \" = ?\");\n                values.push(this.toSqliteValue(delta[columnName]));\n            }\n        });\n\n        this.getPrimaryKeys(columns).forEach((key) => {\n            primaryKeyExpr.push(this._escapeName(key) + \" = ?\");\n            primaryKeyValues.push(entity[key]);\n        });\n\n        values = values.concat(primaryKeyValues);\n\n        return {\n            statement: `UPDATE [${schema}].[${table.name}] SET ${columnSet.join(\", \")} WHERE ${primaryKeyExpr.join(\" AND \")}`,\n            values: values\n        };\n    }\n\n    createDeleteStatement(schema, table, entity) {\n        if (schema == null) {\n            throw new Error(\"Null Argument Exception: schema cannot be null or undefined.\");\n        }\n\n        if (table == null) {\n            throw new Error(\"Null Argument Exception: table cannot be null or undefined.\");\n        }\n\n        if (entity == null) {\n            throw new Error(\"Null Argument Exception: entity cannot be null or undefined.\");\n        }\n\n        const primaryKeysExpr = [];\n        const values = [];\n        const primaryKeys = this.getPrimaryKeys(table.columns);\n\n        primaryKeys.forEach((primaryKey) => {\n\n            if (entity[primaryKey] === null) {\n                primaryKeysExpr.push(this._escapeName(primaryKey) + \" IS NULL\");\n            } else {\n                primaryKeysExpr.push(this._escapeName(primaryKey) + \" = ?\");\n                values.push(this.toSqliteValue(entity[primaryKey]));\n            }\n\n        });\n\n        return {\n            statement: `DELETE FROM [${schema}].[${table.name}] WHERE ${primaryKeysExpr.join(\" AND \")}`,\n            values: values\n        };\n    }\n\n    createColumnDefinitionStatement(table, column) {\n        const sqliteDataType = this.dataTypeMapping[column.type];\n        const primaryKeyStatment = \"\";\n        const primaryKeys = this.getPrimaryKeys(table.columns);\n\n        if (sqliteDataType != null) {\n            let primaryKey = \"\";\n\n            if (column.isPrimaryKey) {\n\n                if (primaryKeys.length === 1) {\n                    primaryKey = \" PRIMARY KEY\";\n                }\n\n                if (column.isAutoIncrement) {\n                    primaryKey += \" IDENTITY(1,1)\";\n                }\n            }\n\n            return `${this._escapeName(column.name)} ${this.dataTypeMapping[column.type] + primaryKey}`\n\n        } else {\n            return null;\n        }\n    }\n\n    createColumnsDefinitionStatement(table) {\n        const columns = table.columns;\n        const columnsDefinition = columns.map((column) => {\n            return this.createColumnDefinitionStatement(table, column);\n        }).filter((value) => {\n            return value != null;\n        }).join(\", \")\n\n        return columnsDefinition;\n    }\n\n    createIndexStatement(schema, table, column) {\n        return `IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[${schema}].[${table}]') AND name = N'index_${column.replace(/\\\"/g, '\"\"')}')\n                  CREATE INDEX index_${column.replace(/\\\"/g, '\"\"')} ON [${schema}].[${table}] (${this._escapeName(column)})`;\n    }\n\n    // TODO: Update for mssql\n    createTableIndexesStatements(schema, table, relationships) {\n        if (relationships == null) {\n            throw new Error(\"Null Argument Exception: relationships cannot be null or undefined.\");\n        }\n\n        const indexedColumns = {};\n\n        const foreignKeyIndexes = this.getTablesRelationshipsAsTargets(table, relationships).forEach((relationship) => {\n            indexedColumns[relationship.withForeignKey] = true;\n        });\n\n        const primaryKeys = this.getPrimaryKeys(table.columns);\n\n        this.getTablesRelationshipsAsSources(table, relationships).filter((relationship) => {\n            return primaryKeys.indexOf(relationship.hasKey) === -1;\n        }).forEach((relationship) => {\n            return indexedColumns[relationship.hasKey] = true;\n        });\n\n        primaryKeys.forEach((name) => {\n            indexedColumns[name] = true;\n        });\n\n        table.columns.filter((column) => {\n            return column.isIndexed;\n        }).map((column) => {\n            return indexedColumns[column.name]\n        });\n\n        return Object.keys(indexedColumns).map((columnName) => {\n            return this.createIndexStatement(schema, table.name, columnName);\n        });\n\n    }\n\n    createForeignKeysStatement(schema, table, relationships) {\n        const tableRelationships = this.getTablesRelationshipsAsTargets(table, relationships);\n\n        return tableRelationships.map((relationship) => {\n            return this.createForeignKeyStatement(schema, relationship);\n        }).join(\"/n/t\");\n    }\n\n    createForeignKeyStatement(schema, relationship) {\n        return `CONSTRAINT [c_${relationship.ofType}.${relationship.withForeignKey}_to_${relationship.type}.${relationship.hasKey}] FOREIGN KEY([${relationship.withForeignKey}]) REFERENCES [${schema}].[${relationship.type}] ([${relationship.hasKey}])`;\n    }\n\n    createPrimaryKeyStatement(table) {\n        const primaryKeys = this.getPrimaryKeys(table.columns).map((primaryKey) => {\n            return this._escapeName(primaryKey);\n        });\n\n        if (primaryKeys.length === 0) {\n            return \"\";\n        } else {\n            return `PRIMARY KEY (${primaryKeys.join(\", \")})`;\n        }\n    }\n\n    // TODO: Update for mssql\n    createTableStatement(schema, table, relationships) {\n        relationships = Object.assign({}, defaultRelationships, relationships);\n\n        const columnDefinitionsStatement = this.createColumnsDefinitionStatement(table);\n        const foreignKeysStatement = this.createForeignKeysStatement(schema, table, relationships);\n\n        if (columnDefinitionsStatement && foreignKeysStatement) {\n            return this._wrapIfTableExists(table, schema,\n                `CREATE TABLE [${schema}].[${table.name}] (${columnDefinitionsStatement}, ${foreignKeysStatement})`);\n        } else if (columnDefinitionsStatement) {\n            return this._wrapIfTableExists(table, schema,\n                `CREATE TABLE [${schema}].[${table.name}] (${columnDefinitionsStatement})`);\n        } else {\n            return this._wrapIfTableExists(table, schema,\n                `CREATE TABLE [${schema}].[${table.name}]`);\n        }\n\n    }\n\n    filterRelevantColumns(columns) {\n        return columns.filter((column) => {\n            return this.dataTypeMapping[column.type] != null;\n        });\n    }\n\n    getTablesRelationshipsAsTargets(table, relationships) {\n        const foreignKeyNames = {};\n\n        const filter = (relationship) => {\n            const foreignKey = relationship.withForeignKey;\n\n            if (relationship.ofType === table.name && foreignKeyNames[foreignKey] == null) {\n                foreignKeyNames[foreignKey];\n                return true;\n            }\n            return false;\n        }\n\n        const oneToOne = relationships.oneToOne.filter(filter);\n        const oneToMany = relationships.oneToMany.filter(filter);\n\n        return oneToOne.concat(oneToMany);\n    }\n\n    getTablesRelationshipsAsSources(table, relationships) {\n        const keyNames = {};\n\n        const filter = (relationship) => {\n            const key = relationship.hasKey;\n\n            if (relationship.type === table.name && keyNames[key] == null) {\n                keyNames[key];\n                return true;\n            }\n            return false;\n        }\n\n        const oneToOne = relationships.oneToOne.filter(filter);\n        const oneToMany = relationships.oneToMany.filter(filter);\n\n        return oneToOne.concat(oneToMany);\n    }\n\n    getColumn(table, name) {\n        return table.columns.find((column) => {\n            return column.name === name;\n        });\n    }\n\n    getDefaultValue(column) {\n        return column[`default${column.type}Value`] || null;\n    }\n\n    getPrimaryKeys(columns) {\n        return columns.filter((column) => {\n            return column.isPrimaryKey;\n        }).map((column) => {\n            return column.name;\n        });\n    }\n\n    // TODO: update for MSSQL\n    toMssqlValue(value) {\n        if (typeof value === \"string\") {\n            return value;\n        } else if (typeof value === \"number\") {\n            return value;\n        } else if (typeof value === \"boolean\") {\n            return value ? 1 : 0;\n        } else if (value instanceof Date) {\n            return value.getTime();\n        } else if (value == null) {\n            return null;\n        } else {\n            throw new Error(\"Unknown value.\");\n        }\n    }\n\n}"]}