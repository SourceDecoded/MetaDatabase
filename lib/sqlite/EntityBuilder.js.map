{"version":3,"sources":["../../src/sqlite/EntityBuilder.js"],"names":["flattenMultiKeyMap","multiKeyMap","keys","getKeys","reduce","array","key","concat","get","getValues","object","Object","map","EntityBuilder","name","edm","relationships","table","_getTable","delimiter","tableName","entity","entityMap","attachedEntities","sourceRelationships","_getTablesRelationshipsAsSources","targetRelationships","_getTablesRelationshipsAsTargets","oneToOneRelationships","filter","relationship","hasOne","oneToManyRelationships","hasMany","forEach","foreignTableName","ofType","foreignKey","withForeignKey","hasKey","target","find","indexOf","_attachEntityRelationships","targets","push","sourceTableName","type","withOne","source","row","_getKeyForRow","_createEntity","parts","split","columnName","value","parseFloat","parseInt","Date","Error","columns","column","_convertValue","tables","accumulator","_getPrimaryKeys","join","isPrimaryKey","foreignKeyNames","oneToOne","oneToMany","keyNames","sqlResults","length","_createEntityMap","results","_convertRow"],"mappings":";;;;;;;;;;AACA,IAAIA,qBAAqB,SAArBA,kBAAqB,CAACC,WAAD,EAAiB;AACtC,QAAIC,OAAOD,YAAYE,OAAZ,EAAX;AACA,WAAOD,KAAKE,MAAL,CAAY,UAAUC,KAAV,EAAiBC,GAAjB,EAAsB;AACrC,eAAOD,MAAME,MAAN,CAAaN,YAAYO,GAAZ,CAAgBF,GAAhB,EAAqBG,SAArB,EAAb,CAAP;AACH,KAFM,EAEJ,EAFI,CAAP;AAGH,CALD;;AAOA,IAAIA,YAAY,SAAZA,SAAY,CAACC,MAAD,EAAY;AACxB,WAAOC,OAAOT,IAAP,CAAYQ,MAAZ,EAAoBE,GAApB,CAAwB,UAACN,GAAD,EAAS;AACpC,eAAOI,OAAOJ,GAAP,CAAP;AACH,KAFM,CAAP;AAGH,CAJD;;IAMqBO,a;AACjB,2BAAYC,IAAZ,EAAkBC,GAAlB,EAAuB;AAAA;;AACnB,aAAKD,IAAL,GAAYA,IAAZ;AACA,aAAKC,GAAL,GAAWA,GAAX;AACA,aAAKC,aAAL,GAAqB,KAAKD,GAAL,CAASC,aAA9B;AACA,aAAKC,KAAL,GAAa,KAAKC,SAAL,CAAeJ,IAAf,CAAb;AACA,aAAKK,SAAL,GAAiB,KAAjB;AACH;;;;mDAE0BC,S,EAAWC,M,EAAQC,S,EAAWC,gB,EAAkB;AAAA;;AACvE,gBAAIN,QAAQ,KAAKC,SAAL,CAAeE,SAAf,CAAZ;;AAEA,gBAAII,sBAAsB,KAAKC,gCAAL,CAAsCR,KAAtC,EAA6C,KAAKD,aAAlD,CAA1B;AACA,gBAAIU,sBAAsB,KAAKC,gCAAL,CAAsCV,KAAtC,EAA6C,KAAKD,aAAlD,CAA1B;;AAEA,gBAAIY,wBAAwBJ,oBAAoBK,MAApB,CAA2B,UAACC,YAAD,EAAkB;AACrE,uBAAOA,aAAaC,MAAb,IAAuB,IAA9B;AACH,aAF2B,CAA5B;;AAIA,gBAAIC,yBAAyBR,oBAAoBK,MAApB,CAA2B,UAACC,YAAD,EAAkB;AACtE,uBAAOA,aAAaG,OAAb,IAAwB,IAA/B;AACH,aAF4B,CAA7B;;AAIAL,kCAAsBM,OAAtB,CAA8B,UAACJ,YAAD,EAAkB;AAC5C,oBAAIK,mBAAmBL,aAAaM,MAApC;AACA,oBAAIC,aAAaP,aAAaQ,cAA9B;AACA,oBAAIhC,MAAMwB,aAAaS,MAAvB;AACA,oBAAIR,SAASD,aAAaC,MAA1B;;AAEA,oBAAIS,SAAS/B,UAAUa,UAAUa,gBAAV,CAAV,EAAuCM,IAAvC,CAA4C,UAACD,MAAD,EAAY;AACjE,2BAAOA,OAAOH,UAAP,MAAuBhB,OAAOf,GAAP,CAA9B;AACH,iBAFY,CAAb;;AAIA,oBAAIkC,UAAU,IAAV,IAAkBjB,iBAAiBmB,OAAjB,CAAyBF,MAAzB,MAAqC,CAAC,CAA5D,EAA+D;AAC3DnB,2BAAOU,MAAP,IAAiBS,MAAjB;;AAEA,0BAAKG,0BAAL,CAAgCR,gBAAhC,EAAkDK,MAAlD,EAA0DlB,SAA1D,EAAqEC,iBAAiBhB,MAAjB,CAAwB,CAACc,MAAD,CAAxB,CAArE;AACH;AACJ,aAfD;;AAiBAW,mCAAuBE,OAAvB,CAA+B,UAACJ,YAAD,EAAkB;AAC7C,oBAAIK,mBAAmBL,aAAaM,MAApC;AACA,oBAAIC,aAAaP,aAAaQ,cAA9B;AACA,oBAAIhC,MAAMwB,aAAaS,MAAvB;AACA,oBAAIN,UAAUH,aAAaG,OAA3B;;AAEA,oBAAIW,UAAUnC,UAAUa,UAAUa,gBAAV,CAAV,EAAuCN,MAAvC,CAA8C,UAACW,MAAD,EAAY;AACpE,2BAAOA,OAAOH,UAAP,MAAuBhB,OAAOf,GAAP,CAA9B;AACH,iBAFa,CAAd;;AAIAe,uBAAOY,OAAP,IAAkB,EAAlB;;AAEAW,wBAAQV,OAAR,CAAgB,UAACM,MAAD,EAAY;AACxB,wBAAIjB,iBAAiBmB,OAAjB,CAAyBF,MAAzB,MAAqC,CAAC,CAA1C,EAA6C;AACzCnB,+BAAOY,OAAP,EAAgBY,IAAhB,CAAqBL,MAArB;AACA,8BAAKG,0BAAL,CAAgCR,gBAAhC,EAAkDK,MAAlD,EAA0DlB,SAA1D,EAAqEC,iBAAiBhB,MAAjB,CAAwB,CAACc,MAAD,CAAxB,CAArE;AACH;AACJ,iBALD;AAMH,aAlBD;;AAoBAK,gCAAoBQ,OAApB,CAA4B,UAACJ,YAAD,EAAkB;AAC1C,oBAAIgB,kBAAkBhB,aAAaiB,IAAnC;AACA,oBAAIV,aAAaP,aAAaQ,cAA9B;AACA,oBAAIhC,MAAMwB,aAAaS,MAAvB;AACA,oBAAIS,UAAUlB,aAAakB,OAA3B;;AAEA,oBAAIC,SAASxC,UAAUa,UAAUwB,eAAV,CAAV,EAAsCL,IAAtC,CAA2C,UAACQ,MAAD,EAAY;AAChE,2BAAOA,OAAO3C,GAAP,MAAgBe,OAAOgB,UAAP,CAAvB;AACH,iBAFY,CAAb;;AAIA,oBAAIY,UAAU,IAAV,IAAkB1B,iBAAiBmB,OAAjB,CAAyBO,MAAzB,MAAqC,CAAC,CAA5D,EAA+D;AAC3D5B,2BAAO2B,OAAP,IAAkBC,MAAlB;;AAEA,0BAAKN,0BAAL,CAAgCG,eAAhC,EAAiDG,MAAjD,EAAyD3B,SAAzD,EAAoEC,iBAAiBhB,MAAjB,CAAwB,CAACc,MAAD,CAAxB,CAApE;AACH;AACJ,aAfD;AAgBH;;;oCAEW6B,G,EAAK5B,S,EAAW;AAAA;;AACxB,gBAAIP,MAAM,KAAKA,GAAf;AACA,gBAAID,OAAO,KAAKA,IAAhB;AACA,gBAAIR,MAAM,KAAK6C,aAAL,CAAmBD,GAAnB,CAAV;AACA,gBAAI7B,SAASC,UAAU,KAAKR,IAAf,EAAqBR,GAArB,CAAb;;AAEA,gBAAIe,UAAU,IAAd,EAAoB;AAChBA,yBAASC,UAAU,KAAKR,IAAf,EAAqBR,GAArB,IAA4B,KAAK8C,aAAL,CAAmBtC,IAAnB,EAAyBoC,GAAzB,CAArC;AACH;;AAEDvC,mBAAOT,IAAP,CAAYgD,GAAZ,EAAiBhB,OAAjB,CAAyB,UAAC5B,GAAD,EAAS;AAC9B,oBAAI+C,QAAQ/C,IAAIgD,KAAJ,CAAU,KAAV,CAAZ;AACA,oBAAIlC,YAAYiC,MAAM,CAAN,CAAhB;AACA,oBAAIE,aAAaF,MAAM,CAAN,CAAjB;;AAEA,oBAAIhC,SAAS,OAAK+B,aAAL,CAAmBhC,SAAnB,EAA8B8B,GAA9B,CAAb;;AAEA,oBAAI7B,UAAU,IAAd,EAAoB;AAChBC,8BAAUF,SAAV,EAAqBd,GAArB,IAA4Be,MAA5B;AACH;AAEJ,aAXD;;AAaA,mBAAOA,MAAP;AACH;;;sCAEa0B,I,EAAMS,K,EAAO;AACvB,gBAAIA,SAAS,IAAb,EAAmB;AACf,uBAAO,IAAP;AACH;;AAED,gBAAIT,SAAS,QAAb,EAAuB;AACnB,uBAAOS,KAAP;AACH,aAFD,MAEO,IAAIT,SAAS,SAAb,EAAwB;AAC3B,uBAAOU,WAAWD,KAAX,CAAP;AACH,aAFM,MAEA,IAAIT,SAAS,SAAb,EAAwB;AAC3B,uBAAOA,QAAQ,GAAR,GAAc,IAAd,GAAqB,KAA5B;AACH,aAFM,MAEA,IAAIA,SAAS,OAAb,EAAsB;AACzB,uBAAOU,WAAWD,KAAX,CAAP;AACH,aAFM,MAEA,IAAIT,SAAS,SAAb,EAAwB;AAC3B,uBAAOU,WAAWD,KAAX,CAAP;AACH,aAFM,MAEA,IAAIT,SAAS,QAAb,EAAuB;AAC1B,uBAAOU,WAAWD,KAAX,CAAP;AACH,aAFM,MAEA,IAAIT,SAAS,SAAb,EAAwB;AAC3B,uBAAOW,SAASF,KAAT,EAAgB,EAAhB,CAAP;AACH,aAFM,MAEA,IAAIT,SAAS,MAAb,EAAqB;AACxB,uBAAO,IAAIY,IAAJ,CAASH,KAAT,CAAP;AACH,aAFM,MAEA,IAAIT,SAAS,MAAb,EAAqB;AACxB,uBAAOW,SAASF,KAAT,EAAgB,EAAhB,CAAP;AACH,aAFM,MAEA;AACH,sBAAM,IAAII,KAAJ,CAAU,eAAV,CAAN;AACH;AACJ;;;sCAEab,I,EAAMG,G,EAAK;AAAA;;AACrB,gBAAI7B,SAAS,EAAb;AACA,gBAAIwC,UAAU,KAAK3C,SAAL,CAAe6B,IAAf,EAAqBc,OAAnC;AACA,gBAAI1C,YAAY,KAAKA,SAArB;;AAEA0C,oBAAQ3B,OAAR,CAAgB,UAAC4B,MAAD,EAAY;AACxBzC,uBAAOyC,OAAOhD,IAAd,IAAsB,OAAKiD,aAAL,CAAmBD,OAAOf,IAA1B,EAAgCG,SAAOH,IAAP,GAAc5B,SAAd,GAA0B2C,OAAOhD,IAAjC,CAAhC,CAAtB;AACH,aAFD;;AAIA,mBAAOO,MAAP;AACH;;;2CAEkB;AACf,mBAAO,KAAKN,GAAL,CAASiD,MAAT,CAAgB5D,MAAhB,CAAuB,UAAC6D,WAAD,EAAchD,KAAd,EAAwB;AAClDgD,4BAAYhD,MAAMH,IAAlB,IAA0B,EAA1B;AACA,uBAAOmD,WAAP;AACH,aAHM,EAGJ,EAHI,CAAP;AAIH;;;yCAEgB5C,M,EAAQ;AACrB,mBAAO,KAAK6C,eAAL,CAAqB,KAAKpD,IAA1B,EAAgCF,GAAhC,CAAoC,UAACN,GAAD,EAAS;AAChD,uBAAOe,OAAOf,GAAP,CAAP;AACH,aAFM,EAEJ6D,IAFI,CAEC,GAFD,CAAP;AAGH;;;sCAEajB,G,EAAK;AAAA;;AACf,mBAAO,KAAKgB,eAAL,CAAqB,KAAKpD,IAA1B,EAAgCF,GAAhC,CAAoC,UAACN,GAAD,EAAS;AAChD,uBAAO4C,SAAO,OAAKpC,IAAZ,GAAmB,OAAKK,SAAxB,GAAoCb,GAApC,CAAP;AACH,aAFM,EAEJ6D,IAFI,CAEC,GAFD,CAAP;AAGH;;;wCAEerD,I,EAAM;AAClB,mBAAO,KAAKI,SAAL,CAAeJ,IAAf,EAAqB+C,OAArB,CAA6BhC,MAA7B,CAAoC,UAACiC,MAAD,EAAY;AACnD,uBAAOA,OAAOM,YAAd;AACH,aAFM,EAEJxD,GAFI,CAEA,UAACkD,MAAD,EAAY;AACf,uBAAOA,OAAOhD,IAAd;AACH,aAJM,CAAP;AAKH;;;kCAESA,I,EAAM;AACZ,mBAAO,KAAKC,GAAL,CAASiD,MAAT,CAAgBvB,IAAhB,CAAqB,UAACxB,KAAD,EAAW;AACnC,uBAAOA,MAAMH,IAAN,KAAeA,IAAtB;AACH,aAFM,CAAP;AAGH;;;yDAEgCG,K,EAAOD,a,EAAe;AACnD,gBAAMqD,kBAAkB,EAAxB;;AAEA,gBAAMxC,SAAS,SAATA,MAAS,CAACC,YAAD,EAAkB;AAC7B,oBAAMO,aAAaP,aAAaQ,cAAhC;;AAEA,oBAAIR,aAAaM,MAAb,KAAwBnB,MAAMH,IAA9B,IAAsCuD,gBAAgBhC,UAAhB,KAA+B,IAAzE,EAA+E;AAC3EgC,oCAAgBhC,UAAhB;AACA,2BAAO,IAAP;AACH;AACD,uBAAO,KAAP;AACH,aARD;;AAUA,gBAAMiC,WAAWtD,cAAcsD,QAAd,CAAuBzC,MAAvB,CAA8BA,MAA9B,CAAjB;AACA,gBAAM0C,YAAYvD,cAAcuD,SAAd,CAAwB1C,MAAxB,CAA+BA,MAA/B,CAAlB;;AAEA,mBAAOyC,SAAS/D,MAAT,CAAgBgE,SAAhB,CAAP;AACH;;;yDAEgCtD,K,EAAOD,a,EAAe;AACnD,gBAAMwD,WAAW,EAAjB;;AAEA,gBAAM3C,SAAS,SAATA,MAAS,CAACC,YAAD,EAAkB;AAC7B,oBAAMxB,MAAMwB,aAAaS,MAAzB;;AAEA,oBAAIT,aAAaiB,IAAb,KAAsB9B,MAAMH,IAA5B,IAAoC0D,SAASlE,GAAT,KAAiB,IAAzD,EAA+D;AAC3DkE,6BAASlE,GAAT;AACA,2BAAO,IAAP;AACH;AACD,uBAAO,KAAP;AACH,aARD;;AAUA,gBAAMgE,WAAWtD,cAAcsD,QAAd,CAAuBzC,MAAvB,CAA8BA,MAA9B,CAAjB;AACA,gBAAM0C,YAAYvD,cAAcuD,SAAd,CAAwB1C,MAAxB,CAA+BA,MAA/B,CAAlB;;AAEA,mBAAOyC,SAAS/D,MAAT,CAAgBgE,SAAhB,CAAP;AACH;;;gCAEOE,U,EAAY;AAAA;;AAChB,gBAAI3D,OAAO,KAAKA,IAAhB;;AAEA,gBAAI2D,WAAWC,MAAX,GAAoB,CAAxB,EAA2B;AACvB,oBAAIpD,YAAY,KAAKqD,gBAAL,EAAhB;;AAEA,oBAAIC,UAAUH,WAAW7D,GAAX,CAAe,UAACsC,GAAD,EAAS;AAClC,2BAAO,OAAK2B,WAAL,CAAiB3B,GAAjB,EAAsB5B,SAAtB,CAAP;AACH,iBAFa,CAAd;;AAIAX,uBAAOT,IAAP,CAAYoB,SAAZ,EAAuBY,OAAvB,CAA+B,UAAC5B,GAAD,EAAS;AACpC,wBAAI+C,QAAQ/C,IAAIgD,KAAJ,CAAU,KAAV,CAAZ;AACA,wBAAIlC,YAAYiC,MAAM,CAAN,CAAhB;AACA,wBAAIhC,SAASC,UAAUhB,GAAV,CAAb;;AAEA,2BAAKqC,0BAAL,CAAgCvB,SAAhC,EAA2CC,MAA3C,EAAmDC,SAAnD,EAA8D,EAA9D;AACH,iBAND;;AAQA,uBAAOsD,OAAP;AACH,aAhBD,MAgBO;AACH,uBAAO,EAAP;AACH;AACJ;;;;;;kBA7OgB/D,a","file":"EntityBuilder.js","sourcesContent":["\nlet flattenMultiKeyMap = (multiKeyMap) => {\n    let keys = multiKeyMap.getKeys();\n    return keys.reduce(function (array, key) {\n        return array.concat(multiKeyMap.get(key).getValues());\n    }, []);\n};\n\nlet getValues = (object) => {\n    return Object.keys(object).map((key) => {\n        return object[key];\n    });\n};\n\nexport default class EntityBuilder {\n    constructor(name, edm) {\n        this.name = name;\n        this.edm = edm;\n        this.relationships = this.edm.relationships;\n        this.table = this._getTable(name);\n        this.delimiter = \"___\";\n    }\n\n    _attachEntityRelationships(tableName, entity, entityMap, attachedEntities) {\n        let table = this._getTable(tableName);\n\n        let sourceRelationships = this._getTablesRelationshipsAsSources(table, this.relationships);\n        let targetRelationships = this._getTablesRelationshipsAsTargets(table, this.relationships);\n\n        let oneToOneRelationships = sourceRelationships.filter((relationship) => {\n            return relationship.hasOne != null;\n        });\n\n        let oneToManyRelationships = sourceRelationships.filter((relationship) => {\n            return relationship.hasMany != null;\n        });\n\n        oneToOneRelationships.forEach((relationship) => {\n            let foreignTableName = relationship.ofType;\n            let foreignKey = relationship.withForeignKey;\n            let key = relationship.hasKey;\n            let hasOne = relationship.hasOne;\n\n            let target = getValues(entityMap[foreignTableName]).find((target) => {\n                return target[foreignKey] === entity[key];\n            });\n\n            if (target != null && attachedEntities.indexOf(target) === -1) {\n                entity[hasOne] = target;\n\n                this._attachEntityRelationships(foreignTableName, target, entityMap, attachedEntities.concat([entity]));\n            }\n        });\n\n        oneToManyRelationships.forEach((relationship) => {\n            let foreignTableName = relationship.ofType;\n            let foreignKey = relationship.withForeignKey;\n            let key = relationship.hasKey;\n            let hasMany = relationship.hasMany;\n\n            let targets = getValues(entityMap[foreignTableName]).filter((target) => {\n                return target[foreignKey] === entity[key];\n            });\n\n            entity[hasMany] = [];\n\n            targets.forEach((target) => {\n                if (attachedEntities.indexOf(target) === -1) {\n                    entity[hasMany].push(target);\n                    this._attachEntityRelationships(foreignTableName, target, entityMap, attachedEntities.concat([entity]));\n                }\n            });\n        });\n\n        targetRelationships.forEach((relationship) => {\n            let sourceTableName = relationship.type;\n            let foreignKey = relationship.withForeignKey;\n            let key = relationship.hasKey;\n            let withOne = relationship.withOne;\n\n            let source = getValues(entityMap[sourceTableName]).find((source) => {\n                return source[key] === entity[foreignKey];\n            });\n\n            if (source != null && attachedEntities.indexOf(source) === -1) {\n                entity[withOne] = source;\n\n                this._attachEntityRelationships(sourceTableName, source, entityMap, attachedEntities.concat([entity]));\n            }\n        });\n    }\n\n    _convertRow(row, entityMap) {\n        let edm = this.edm;\n        let name = this.name;\n        let key = this._getKeyForRow(row);\n        let entity = entityMap[this.name][key];\n\n        if (entity == null) {\n            entity = entityMap[this.name][key] = this._createEntity(name, row);\n        }\n\n        Object.keys(row).forEach((key) => {\n            let parts = key.split(\"___\");\n            let tableName = parts[0];\n            let columnName = parts[1];\n\n            let entity = this._createEntity(tableName, row);\n\n            if (entity == null) {\n                entityMap[tableName][key] = entity;\n            }\n\n        });\n\n        return entity;\n    }\n\n    _convertValue(type, value) {\n        if (value == null) {\n            return null;\n        }\n\n        if (type === \"String\") {\n            return value;\n        } else if (type === \"Numeric\") {\n            return parseFloat(value);\n        } else if (type === \"Boolean\") {\n            return type == \"1\" ? true : false;\n        } else if (type === \"Float\") {\n            return parseFloat(value);\n        } else if (type === \"Decimal\") {\n            return parseFloat(value);\n        } else if (type === \"Double\") {\n            return parseFloat(value);\n        } else if (type === \"Integer\") {\n            return parseInt(value, 10);\n        } else if (type === \"Date\") {\n            return new Date(value);\n        } else if (type === \"Enum\") {\n            return parseInt(value, 10);\n        } else {\n            throw new Error(\"Unknown type.\");\n        }\n    }\n\n    _createEntity(type, row) {\n        let entity = {};\n        let columns = this._getTable(type).columns;\n        let delimiter = this.delimiter;\n\n        columns.forEach((column) => {\n            entity[column.name] = this._convertValue(column.type, row[`${type}${delimiter}${column.name}`]);\n        });\n\n        return entity;\n    }\n\n    _createEntityMap() {\n        return this.edm.tables.reduce((accumulator, table) => {\n            accumulator[table.name] = {};\n            return accumulator;\n        }, {});\n    }\n\n    _getKeyForEntity(entity) {\n        return this._getPrimaryKeys(this.name).map((key) => {\n            return entity[key];\n        }).join(\"|\");\n    }\n\n    _getKeyForRow(row) {\n        return this._getPrimaryKeys(this.name).map((key) => {\n            return row[`${this.name}${this.delimiter}${key}`];\n        }).join(\"|\");\n    }\n\n    _getPrimaryKeys(name) {\n        return this._getTable(name).columns.filter((column) => {\n            return column.isPrimaryKey;\n        }).map((column) => {\n            return column.name;\n        });\n    }\n\n    _getTable(name) {\n        return this.edm.tables.find((table) => {\n            return table.name === name;\n        });\n    }\n\n    _getTablesRelationshipsAsTargets(table, relationships) {\n        const foreignKeyNames = {};\n\n        const filter = (relationship) => {\n            const foreignKey = relationship.withForeignKey;\n\n            if (relationship.ofType === table.name && foreignKeyNames[foreignKey] == null) {\n                foreignKeyNames[foreignKey];\n                return true;\n            }\n            return false;\n        }\n\n        const oneToOne = relationships.oneToOne.filter(filter);\n        const oneToMany = relationships.oneToMany.filter(filter);\n\n        return oneToOne.concat(oneToMany);\n    }\n\n    _getTablesRelationshipsAsSources(table, relationships) {\n        const keyNames = {};\n\n        const filter = (relationship) => {\n            const key = relationship.hasKey;\n\n            if (relationship.type === table.name && keyNames[key] == null) {\n                keyNames[key];\n                return true;\n            }\n            return false;\n        }\n\n        const oneToOne = relationships.oneToOne.filter(filter);\n        const oneToMany = relationships.oneToMany.filter(filter);\n\n        return oneToOne.concat(oneToMany);\n    }\n\n    convert(sqlResults) {\n        let name = this.name;\n\n        if (sqlResults.length > 0) {\n            let entityMap = this._createEntityMap();\n\n            let results = sqlResults.map((row) => {\n                return this._convertRow(row, entityMap);\n            });\n\n            Object.keys(entityMap).forEach((key) => {\n                let parts = key.split(\"_|_\");\n                let tableName = parts[0];\n                let entity = entityMap[key];\n\n                this._attachEntityRelationships(tableName, entity, entityMap, []);\n            });\n\n            return results;\n        } else {\n            return [];\n        }\n    }\n\n\n}"]}